<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.klaiverjoin.mappers.JoinMapper">
	<insert id="k_joinone">
		INSERT INTO k_joinone (last, first, email,
		password,salt)
		VALUES (#{last}, #{first}, #{email}, #{password}, #{salt});
	</insert>

	<insert id="k_jointwo" parameterType="com.test.domain.JoinOne"
		useGeneratedKeys="true" keyProperty="one_id">
		<selectKey resultType="int" keyProperty="one_id" order="BEFORE">
			SELECT
			COALESCE(MAX(one_id),0)
			FROM k_joinone;
		</selectKey>
		INSERT INTO k_jointwo (company, title, industry,one_id)
		VALUES
		(#{company}, #{title}, #{industry}, #{one_id});

	</insert>
 
	<insert id="k_jointhree" parameterType="com.test.domain.JoinTwo"
		useGeneratedKeys="true" keyProperty="two_id">
	<selectKey resultType="int" keyProperty="two_id" order="BEFORE">
			SELECT
			COALESCE(MAX(two_id),0)
			FROM k_jointwo;
		</selectKey>
		INSERT INTO k_jointhree (country,
		city,two_id)
		VALUES
		(#{ country }, #{ city }, #{ two_id });

	</insert>
	<select id="getid" resultType="com.test.domain.JoinOne">
	SELECT
	email
	FROM
	k_joinone where email=#{id};
	</select>

</mapper>


